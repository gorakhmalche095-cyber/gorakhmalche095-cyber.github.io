<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login | SunPower Premium</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@800&family=Montserrat:wght@700;900&display=swap" rel="stylesheet">
    
    <style>
        body { background: radial-gradient(circle at top, #f0f9ff 0%, #e2e8f0 100%); font-family: 'Montserrat', sans-serif; min-height: 100vh; }
        .font-brand { font-family: 'Orbitron', sans-serif; background: linear-gradient(135deg, #0369a1 0%, #2563eb 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .premium-card { background: rgba(255, 255, 255, 0.95); border-radius: 40px; box-shadow: 0 40px 100px -20px rgba(2, 132, 199, 0.15); border: 1px solid rgba(255, 255, 255, 1); }
        .input-box { background: #f1f5f9; border: 2px solid transparent; border-radius: 20px; transition: all 0.3s ease; }
        .input-box:focus-within { border-color: #3b82f6; background: #ffffff; box-shadow: 0 8px 20px -5px rgba(59, 130, 246, 0.1); }
        .vibrant-btn { background: linear-gradient(90deg, #0284c7 0%, #2563eb 100%); box-shadow: 0 15px 30px -5px rgba(37, 99, 235, 0.3); transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        .vibrant-btn:hover { box-shadow: 0 20px 40px -10px rgba(37, 99, 235, 0.4); transform: translateY(-2px); }
        .vibrant-btn:active { transform: scale(0.95); }
        .modal-active { display: flex !important; animation: popIn 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55); }
        @keyframes popIn { from { opacity: 0; transform: scale(0.8); } to { opacity: 1; transform: scale(1); } }
        .custom-checkbox { width: 18px; height: 18px; cursor: pointer; accent-color: #2563eb; }
    </style>
</head>
<body class="flex items-center justify-center p-6 text-slate-800">

    <div id="customAlert" class="fixed inset-0 bg-slate-900/60 z-[200] hidden items-center justify-center p-6 backdrop-blur-md">
        <div class="bg-white w-full max-w-xs rounded-[40px] p-8 text-center shadow-2xl border border-slate-100">
            <div id="alertIcon" class="w-20 h-20 bg-blue-50 rounded-full flex items-center justify-center mx-auto mb-5 text-3xl">
                <i class="fas fa-info-circle text-blue-500"></i>
            </div>
            <h3 id="alertTitle" class="font-black uppercase text-xs mb-2 tracking-[0.2em] text-slate-400">Security Check</h3>
            <p id="alertMsg" class="text-[12px] font-bold text-slate-600 leading-relaxed mb-8 px-2"></p>
            <button id="alertBtn" onclick="closeAlert()" class="w-full vibrant-btn text-white py-4 rounded-2xl font-black uppercase text-[10px] tracking-widest">Understand</button>
        </div>
    </div>

    <div class="w-full max-w-sm premium-card overflow-hidden">
        <div class="p-10 text-center bg-gradient-to-b from-blue-50/50 to-transparent">
            <h1 class="font-brand text-4xl uppercase mb-1 drop-shadow-sm">SUN POWER</h1>
            <p class="text-[9px] font-black uppercase tracking-[6px] text-blue-400/80">Premium Investment</p>
        </div>

        <div class="px-10 pb-12">
            <div class="mb-8 text-center">
                <h2 class="text-[10px] font-black text-slate-400 uppercase tracking-[0.4em]">Member Login</h2>
                <div class="h-1 w-8 bg-blue-500 mx-auto mt-3 rounded-full"></div>
            </div>
            
            <form id="loginForm" class="space-y-5">
                <div class="input-box flex items-center px-5 py-4">
                    <div class="flex items-center mr-3 border-r border-slate-200 pr-3">
                        <span class="text-[11px] font-black text-blue-600">+91</span>
                    </div>
                    <input type="tel" id="loginMobile" placeholder="MOBILE NUMBER" maxlength="10" oninput="this.value = this.value.replace(/[^0-9]/g, '').slice(0, 10);" class="w-full bg-transparent outline-none font-bold text-xs tracking-[0.2em] text-slate-700" required>
                </div>

                <div class="input-box flex items-center px-5 py-4">
                    <i class="fas fa-shield-alt text-blue-500/40 mr-4 text-sm"></i>
                    <input type="password" id="loginPass" placeholder="PASSWORD" class="w-full bg-transparent outline-none font-bold text-xs tracking-[0.2em] text-slate-700" required>
                    <button type="button" onclick="togglePassword()" class="ml-2 focus:outline-none">
                        <i id="eyeIcon" class="fas fa-eye text-slate-400 text-xs"></i>
                    </button>
                </div>

                <div class="flex justify-end px-1">
                    <button type="button" onclick="forgotPassword()" class="text-[9px] font-black text-blue-500/80 uppercase tracking-widest flex items-center gap-1.5">
                        <i class="fas fa-key text-[8px]"></i> Reset Password
                    </button>
                </div>

                <div class="flex items-start gap-3 px-1 mt-6">
                    <input type="checkbox" id="termsCheck" class="custom-checkbox mt-0.5">
                    <label for="termsCheck" class="text-[10px] text-slate-500 font-semibold leading-snug">
                        I have read and agree to the <a href="terms.html" class="text-blue-600 border-b border-blue-200">Terms & Conditions</a> of SunPower.
                    </label>
                </div>

                <button type="submit" class="w-full vibrant-btn text-white font-black py-5 rounded-[22px] mt-2 uppercase text-[11px] tracking-[0.2em]">
                    Access Account
                </button>
            </form>

            <div class="mt-10 text-center">
                <p class="text-[10px] text-slate-400 font-bold uppercase tracking-widest">Create New Account?</p>
                <a href="register.html" class="inline-block mt-2 text-[11px] text-blue-600 font-black border-b-2 border-blue-100 uppercase tracking-widest">CREATE ACCOUNT</a>
            </div>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyA3k5ByUuJ-1jtVovgZMxsw1LBaBkn_nDo",
            authDomain: "new-investment-web.firebaseapp.com",
            projectId: "new-investment-web",
            storageBucket: "new-investment-web.firebasestorage.app",
            messagingSenderId: "1078188475858",
            appId: "1:1078188475858:web:b3777ea127aae8083740b"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        let redirectUrl = null;

        // SHOW/HIDE PASSWORD
        window.togglePassword = () => {
            const passInput = document.getElementById('loginPass');
            const eyeIcon = document.getElementById('eyeIcon');
            if (passInput.type === "password") {
                passInput.type = "text";
                eyeIcon.classList.replace('fa-eye', 'fa-eye-slash');
            } else {
                passInput.type = "password";
                eyeIcon.classList.replace('fa-eye-slash', 'fa-eye');
            }
        };

        // RESET PASSWORD BUTTON (TELEGRAM AUTO MESSAGE)
        window.forgotPassword = () => {
            const mobile = document.getElementById("loginMobile").value.trim();

            let message = "Hello SunPower Help, I want to reset my password.";

            if (mobile.length === 10) {
                message = `Hello SunPower Help, I want to reset my password.\n\nMy Registered Mobile Number: +91${mobile}`;
            }

            const telegramLink = `https://t.me/SunPowerHelp?text=${encodeURIComponent(message)}`;

            window.open(telegramLink, "_blank");
        };

        // CUSTOM ALERT POPUP
        window.showAlert = (msg, type = 'info', redirect = null) => {
            const modal = document.getElementById('customAlert');
            const icon = document.getElementById('alertIcon');
            const title = document.getElementById('alertTitle');
            redirectUrl = redirect;
            document.getElementById('alertMsg').innerText = msg;
            
            if(type === 'success') { 
                icon.innerHTML = '<i class="fas fa-check-double text-emerald-500"></i>';
                icon.style.background = '#ecfdf5';
                title.innerText = "Authorized"; 
            } else if(type === 'error') { 
                icon.innerHTML = '<i class="fas fa-fingerprint text-rose-500"></i>';
                icon.style.background = '#fff1f2';
                title.innerText = "Access Denied"; 
            } else {
                icon.innerHTML = '<i class="fas fa-info-circle text-blue-500"></i>';
                icon.style.background = '#eff6ff';
                title.innerText = "Security Check";
            }

            modal.classList.add('modal-active');
        };

        window.closeAlert = () => { 
            document.getElementById('customAlert').classList.remove('modal-active');
            if(redirectUrl) window.location.href = redirectUrl;
        };

        // LOGIN FORM
        document.getElementById('loginForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const isChecked = document.getElementById('termsCheck').checked;
            if(!isChecked) {
                showAlert("Please check the Terms & Conditions to continue.", "info");
                return;
            }

            const mobile = document.getElementById('loginMobile').value;
            const pass = document.getElementById('loginPass').value;

            try {
                const userSnap = await getDoc(doc(db, "users", mobile));

                if (userSnap.exists()) {
                    if (userSnap.data().password === pass) {
                        localStorage.setItem('userMobile', mobile);
                        showAlert("Verified. Welcome!", "success");
                        setTimeout(() => { window.location.href = "index.html"; }, 1500);
                    } else { 
                        showAlert("Incorrect password!", "error"); 
                    }
                } else { 
                    showAlert("Account not found. Please register first.", "info", "register.html");
                    setTimeout(() => { window.location.href = "register.html"; }, 3000);
                }
            } catch (error) { 
                showAlert("Connection error!", "error"); 
            }
        });
    </script>
</body>
</html>
